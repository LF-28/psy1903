barplot <-
ggplot(data.frame(
condition = c("Congruent", "Incongruent"),
mean_rt = bar_vals,
sd_rt = sd_vals
),
aes(condition, mean_rt)
) + geom_col(fill = "steelblue") +
labs(x = "Focus Group", y = "Mean RT (ms)") +
geom_errorbar(aes(ymin = mean_rt - sd_rt, ymax = mean_rt + sd_rt))+
theme_ef()
print(barplot)
#| label: fig-bar
#| fig-cap: "Mean RT between Congruent and Incongruent Trials."
barplot <-
ggplot(data.frame(
condition = c("Congruent", "Incongruent"),
mean_rt = bar_vals,
sd_rt = sd_vals
),
aes(condition, mean_rt)
) + geom_col(fill = "steelblue") +
labs(x = "Focus Group", y = "Mean RT (ms)") +
geom_errorbar(aes(ymin = mean_rt - sd_rt, ymax = mean_rt + sd_rt, width=.5))+
theme_ef()
print(barplot)
#| label: fig-scatter-line
#| fig-cap: "Scatterplot with a fitted regression line showing the D-scores and anxiety scores."
## Correlation test
cor_test <- cor.test(participant_wide$d_score,
participant_wide$anxiety_score)
## Scatterplot + regression line
scatterplot <- ggplot(participant_wide, aes(x = d_score, y = anxiety_score)) +
geom_point(color = "gray40") +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(x = "D-score",
y = "Anxiety score") +
theme_minimal()
print(scatterplot)
#| label: fig-scatter-line
#| fig-cap: "Scatterplot with a fitted regression line showing the D-scores and anxiety scores."
## Correlation test
cor_test <- cor.test(participant_wide$d_score,
participant_wide$anxiety_score)
## Scatterplot + regression line
scatterplot <- ggplot(participant_wide, aes(x = d_score, y = anxiety_score)) +
geom_point(color = "darkslategray") +
geom_smooth(method = "lm", se = FALSE, color = "steelblue") +
labs(x = "D-score",
y = "Anxiety score") +
theme_minimal()
print(scatterplot)
#| label: fig-scatter-line
#| fig-cap: "Scatterplot with a fitted regression line showing the D-scores and anxiety scores."
## Correlation test
cor_test <- cor.test(participant_wide$d_score,
participant_wide$anxiety_score)
## Scatterplot + regression line
scatterplot <- ggplot(participant_wide, aes(x = d_score, y = anxiety_score)) +
geom_point(color = "darkslategray") +
geom_smooth(method = "lm", se = FALSE, color = "steelblue") +
labs(title= "D-Score Correlation with Anxiety Score",x = "D-score",
y = "Anxiety score") +
theme_ef()
print(scatterplot)
#| label: fig-bar
#| fig-cap: "Mean RT between Congruent and Incongruent Trials."
barplot <-
ggplot(data.frame(
condition = c("Congruent", "Incongruent"),
mean_rt = bar_vals,
sd_rt = sd_vals
),
aes(condition, mean_rt)
) + geom_col(fill = "cyan4") +
labs(title= "Mean RT Across Trials Congruency", x = "Trial", y = "Mean RT (ms)") +
geom_errorbar(aes(ymin = mean_rt - sd_rt, ymax = mean_rt + sd_rt, width=.2))+
theme_ef()
print(barplot)
#| label: fig-d-hist-lines
#| fig-cap: "Histogram of D-scores with mean."
## Compute summary statistics
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
## Histogram with reference lines
hist <- ggplot(participant_wide, aes(x = d_score)) +
geom_histogram(bins = 5,
fill = "gray80",
color = "black") +
geom_vline(xintercept = d_mean,         color = "deepskyblue") +
geom_vline(xintercept = d_mean - d_sd, color = "darkred", linetype = "dashed") +
geom_vline(xintercept = d_mean + d_sd, color = "darkred", linetype = "dashed") +
labs(title= "Distribution of IAT D-Scores", x = "D-score", y = "Count") +
theme_ef()
print(hist)
theme_ef <- function(base_size = 12) {
theme_classic(base_size = base_size) +
theme(
plot.title   = element_text(size = base_size + 4, face = "bold", hjust = 0.5),
axis.title   = element_text(size = base_size + 2),
axis.text    = element_text(size = base_size),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
panel.grid.major.y = element_line(color = "grey85", linewidth = 0.1),
panel.grid.major.x = element_line(color = "grey85", linewidth = 0.1),
legend.position = "bottom",
legend.title    = element_text(size = base_size),
legend.text     = element_text(size = base_size - 1),
plot.margin     = margin(10, 20, 10, 20),
panel.spacing = grid::unit(1, "lines")
)
}
#| label: fig-d-hist-lines
#| fig-cap: "Histogram of D-scores with mean."
## Compute summary statistics
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
## Histogram with reference lines
hist <- ggplot(participant_wide, aes(x = d_score)) +
geom_histogram(bins = 5,
fill = "gray80",
color = "black") +
geom_vline(xintercept = d_mean,         color = "deepskyblue") +
geom_vline(xintercept = d_mean - d_sd, color = "darkred", linetype = "dashed") +
geom_vline(xintercept = d_mean + d_sd, color = "darkred", linetype = "dashed") +
labs(title= "Distribution of IAT D-Scores", x = "D-score", y = "Count") +
theme_ef()
print(hist)
#| label: fig-bar
#| fig-cap: "Mean RT between Congruent and Incongruent Trials."
barplot <-
ggplot(data.frame(
condition = c("Congruent", "Incongruent"),
mean_rt = bar_vals,
sd_rt = sd_vals
),
aes(condition, mean_rt)
) + geom_col(fill = "cyan4") +
labs(title= "Mean RT Across Trials Congruency", x = "Trial", y = "Mean RT (ms)") +
geom_errorbar(aes(ymin = mean_rt - sd_rt, ymax = mean_rt + sd_rt, width=.2))+
theme_ef()
print(barplot)
#| label: fig-scatter-line
#| fig-cap: "Scatterplot with a fitted regression line showing the D-scores and anxiety scores."
## Correlation test
cor_test <- cor.test(participant_wide$d_score,
participant_wide$anxiety_score)
## Scatterplot + regression line
scatterplot <- ggplot(participant_wide, aes(x = d_score, y = anxiety_score)) +
geom_point(color = "darkslategray") +
geom_smooth(method = "lm", se = FALSE, color = "steelblue") +
labs(title= "D-Score Correlation with Anxiety Score",x = "D-score",
y = "Anxiety score") +
theme_ef()
print(scatterplot)
#| label: fig-d-hist-lines
#| fig-cap: "Histogram of D-scores with mean."
## Compute summary statistics
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
## Histogram with reference lines
histogram <- ggplot(participant_wide, aes(x = d_score)) +
geom_histogram(bins = 5,
fill = "gray80",
color = "black") +
geom_vline(xintercept = d_mean,         color = "deepskyblue") +
geom_vline(xintercept = d_mean - d_sd, color = "darkred", linetype = "dashed") +
geom_vline(xintercept = d_mean + d_sd, color = "darkred", linetype = "dashed") +
labs(title= "Distribution of IAT D-Scores", x = "D-score", y = "Count") +
theme_ef()
print(histogram)
ensure_dir <- function(path) if (!dir.exists(path)) dir.create(path, recursive = TRUE, showWarnings = FALSE)
ensure_dir(file.path(here::here("data","raw")))
ensure_dir(file.path(here::here("data","cleaned")))
ensure_dir(file.path(here::here("outputs","tables")))
ensure_dir(file.path(here::here("outputs","plots")))
if (!require("pacman")) {
install.packages("pacman"); library(pacman, quietly = TRUE)
}
p_load("ggplot2", "here", "jsonlite")
source(here::here("scripts/calculate_iat_dscore.R"))
source(here::here("scripts/score_questionnaire.R"))
source(here::here("scripts/summarize_behavior.R"))
source(here::here("scripts/import_and_process.R"))
source(here::here("scripts/build_participant_wide.R"))
participant_wide <- build_participant_wide()
nrow(participant_wide)
head(participant_wide, 6)
tail(participant_wide, 6)
cols <- c("congruent_mean", "incongruent_mean",
"congruent_accuracy", "incongruent_accuracy",
"d_score", "anxiety_score")
participant_wide[, cols] |>
is.na() |>
colSums() |>
(\(x) {
data.frame(
variable  = names(x),
n_missing = unname(x),
expected  = 0
)
})() |>
print()
cols <- c("congruent_mean",
"incongruent_mean",
"congruent_accuracy",
"incongruent_accuracy",
"d_score",
"anxiety_score")
df_vals <- participant_wide[, cols]
## Calculate Means for all measures
means <- colMeans(df_vals, na.rm = TRUE)
## Calculate Standard Deviations for all measures
sds <- apply(df_vals, 2, sd, na.rm = TRUE)
## Calculate Standard Errors for all measures
ses <- apply(
df_vals,
2,
function(x) sd(x, na.rm = TRUE) / sqrt(sum(!is.na(x)))
)
## RT paired t-test
rt_ttest <- t.test(participant_wide$congruent_mean,
participant_wide$incongruent_mean,
paired = TRUE)
## Accuracy paired t-test
acc_ttest <- t.test(participant_wide$congruent_accuracy,
participant_wide$incongruent_accuracy,
paired = TRUE)
## Correlation between d-score and anxiety score
d_anx_cor <- cor(participant_wide$d_score,
participant_wide$anxiety_score,
use = "complete.obs")
d_anx_test <- cor.test(participant_wide$d_score,
participant_wide$anxiety_score)
if (sum(is.finite(participant_wide$d_score)) > 0) {
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
hist(
participant_wide$d_score,
breaks = 5,
main   = "Distribution of IAT D-scores",
xlab   = "D-score",
ylab   = "Count",
col    = "lightgray",
border = "white"
)
## Add mean line
abline(v = d_mean, col = "blue", lwd = 2)
## Add ±1 SD lines
abline(v = d_mean + d_sd, col = "red", lwd = 2, lty = 2)
abline(v = d_mean - d_sd, col = "red", lwd = 2, lty = 2)
}
bar_vals <- c(means["congruent_mean"], means["incongruent_mean"])
sd_vals  <- c(sds["congruent_mean"],   sds["incongruent_mean"])
## Create the bar plot
bp <- barplot(
bar_vals,
names.arg = c("Congruent", "Incongruent"),
col = c("gray70", "gray40"),
ylab = "Mean RT (ms)",
ylim = c(0, max(bar_vals + sd_vals) * 1.1)
)
## Add error bars
arrows(
x0 = bp, y0 = bar_vals - sd_vals,
x1 = bp, y1 = bar_vals + sd_vals,
angle = 90, code = 3, length = 0.05, lwd = 2
)
print(bp)
## Extract values
d_vals  <- participant_wide$d_score
anx_vals <- participant_wide$anxiety_score
## Calculate correlation
d_anx_cor <- cor(d_vals, anx_vals, use = "complete.obs")
## Plot
plot(d_vals, anx_vals,
main = "Correlation Between D-score and Anxiety",
xlab = "D-score",
ylab = "Anxiety Score",
pch = 19, col = "gray40")
## Add regression line
abline(lm(anx_vals ~ d_vals), col = "blue", lwd = 2)
## Add correlation label on the plot
text(x = min(d_vals, na.rm = TRUE),
y = max(anx_vals, na.rm = TRUE),
labels = paste("r =", round(d_anx_cor, 2)),
pos = 4)
## TODO: Use ggplot2 to re-create:
## (1) histogram of D-scores and
## (2) bar plot of mean RTs. Include standard error bars.
## (3) correlation between anxiety score and d-scores, with regression line
## Improve the overall aesthetic (axes, labels/titles, color, etc.) using a custom theme.
## Use fig-cap to provide captions for each figure.
## You will want to assign each plot to a variable for later saving (e.g., barplot <- ggplot...)
## To display each plot in your rendered Quarto Report, use print()
theme_ef <- function(base_size = 12) {
theme_classic(base_size = base_size) +
theme(
plot.title   = element_text(size = base_size + 4, face = "bold", hjust = 0.5),
axis.title   = element_text(size = base_size + 2),
axis.text    = element_text(size = base_size),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
panel.grid.major.y = element_line(color = "grey85", linewidth = 0.1),
panel.grid.major.x = element_line(color = "grey85", linewidth = 0.1),
legend.position = "bottom",
legend.title    = element_text(size = base_size),
legend.text     = element_text(size = base_size - 1),
plot.margin     = margin(10, 20, 10, 20),
panel.spacing = grid::unit(1, "lines")
)
}
#| label: fig-d-hist-lines
#| fig-cap: "Histogram of D-scores with mean."
## Compute summary statistics
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
## Histogram with reference lines
histogram <- ggplot(participant_wide, aes(x = d_score)) +
geom_histogram(bins = 5,
fill = "gray80",
color = "black") +
geom_vline(xintercept = d_mean,         color = "deepskyblue") +
geom_vline(xintercept = d_mean - d_sd, color = "darkred", linetype = "dashed") +
geom_vline(xintercept = d_mean + d_sd, color = "darkred", linetype = "dashed") +
labs(title= "Distribution of IAT D-Scores", x = "D-score", y = "Count") +
theme_ef()
print(histogram)
#| label: fig-bar
#| fig-cap: "Mean RT between Congruent and Incongruent Trials."
barplot <-
ggplot(data.frame(
condition = c("Congruent", "Incongruent"),
mean_rt = uname(bar_vals),
sd_rt = uname(sd_vals)
),
aes(condition, mean_rt)
) + geom_col(fill = "cyan4") +
labs(title= "Mean RT Across Trials Congruency", x = "Trial", y = "Mean RT (ms)") +
geom_errorbar(aes(ymin = mean_rt - sd_rt, ymax = mean_rt + sd_rt), width=.2)+
theme_ef()
ensure_dir <- function(path) if (!dir.exists(path)) dir.create(path, recursive = TRUE, showWarnings = FALSE)
ensure_dir(file.path(here::here("data","raw")))
ensure_dir(file.path(here::here("data","cleaned")))
ensure_dir(file.path(here::here("outputs","tables")))
ensure_dir(file.path(here::here("outputs","plots")))
if (!require("pacman")) {
install.packages("pacman"); library(pacman, quietly = TRUE)
}
p_load("ggplot2", "here", "jsonlite")
source(here::here("scripts/calculate_iat_dscore.R"))
source(here::here("scripts/score_questionnaire.R"))
source(here::here("scripts/summarize_behavior.R"))
source(here::here("scripts/import_and_process.R"))
source(here::here("scripts/build_participant_wide.R"))
participant_wide <- build_participant_wide()
nrow(participant_wide)
head(participant_wide, 6)
tail(participant_wide, 6)
cols <- c("congruent_mean", "incongruent_mean",
"congruent_accuracy", "incongruent_accuracy",
"d_score", "anxiety_score")
participant_wide[, cols] |>
is.na() |>
colSums() |>
(\(x) {
data.frame(
variable  = names(x),
n_missing = unname(x),
expected  = 0
)
})() |>
print()
cols <- c("congruent_mean",
"incongruent_mean",
"congruent_accuracy",
"incongruent_accuracy",
"d_score",
"anxiety_score")
df_vals <- participant_wide[, cols]
## Calculate Means for all measures
means <- colMeans(df_vals, na.rm = TRUE)
## Calculate Standard Deviations for all measures
sds <- apply(df_vals, 2, sd, na.rm = TRUE)
## Calculate Standard Errors for all measures
ses <- apply(
df_vals,
2,
function(x) sd(x, na.rm = TRUE) / sqrt(sum(!is.na(x)))
)
## RT paired t-test
rt_ttest <- t.test(participant_wide$congruent_mean,
participant_wide$incongruent_mean,
paired = TRUE)
## Accuracy paired t-test
acc_ttest <- t.test(participant_wide$congruent_accuracy,
participant_wide$incongruent_accuracy,
paired = TRUE)
## Correlation between d-score and anxiety score
d_anx_cor <- cor(participant_wide$d_score,
participant_wide$anxiety_score,
use = "complete.obs")
d_anx_test <- cor.test(participant_wide$d_score,
participant_wide$anxiety_score)
if (sum(is.finite(participant_wide$d_score)) > 0) {
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
hist(
participant_wide$d_score,
breaks = 5,
main   = "Distribution of IAT D-scores",
xlab   = "D-score",
ylab   = "Count",
col    = "lightgray",
border = "white"
)
## Add mean line
abline(v = d_mean, col = "blue", lwd = 2)
## Add ±1 SD lines
abline(v = d_mean + d_sd, col = "red", lwd = 2, lty = 2)
abline(v = d_mean - d_sd, col = "red", lwd = 2, lty = 2)
}
bar_vals <- c(means["congruent_mean"], means["incongruent_mean"])
sd_vals  <- c(sds["congruent_mean"],   sds["incongruent_mean"])
## Create the bar plot
bp <- barplot(
bar_vals,
names.arg = c("Congruent", "Incongruent"),
col = c("gray70", "gray40"),
ylab = "Mean RT (ms)",
ylim = c(0, max(bar_vals + sd_vals) * 1.1)
)
## Add error bars
arrows(
x0 = bp, y0 = bar_vals - sd_vals,
x1 = bp, y1 = bar_vals + sd_vals,
angle = 90, code = 3, length = 0.05, lwd = 2
)
print(bp)
## Extract values
d_vals  <- participant_wide$d_score
anx_vals <- participant_wide$anxiety_score
## Calculate correlation
d_anx_cor <- cor(d_vals, anx_vals, use = "complete.obs")
## Plot
plot(d_vals, anx_vals,
main = "Correlation Between D-score and Anxiety",
xlab = "D-score",
ylab = "Anxiety Score",
pch = 19, col = "gray40")
## Add regression line
abline(lm(anx_vals ~ d_vals), col = "blue", lwd = 2)
## Add correlation label on the plot
text(x = min(d_vals, na.rm = TRUE),
y = max(anx_vals, na.rm = TRUE),
labels = paste("r =", round(d_anx_cor, 2)),
pos = 4)
## TODO: Use ggplot2 to re-create:
## (1) histogram of D-scores and
## (2) bar plot of mean RTs. Include standard error bars.
## (3) correlation between anxiety score and d-scores, with regression line
## Improve the overall aesthetic (axes, labels/titles, color, etc.) using a custom theme.
## Use fig-cap to provide captions for each figure.
## You will want to assign each plot to a variable for later saving (e.g., barplot <- ggplot...)
## To display each plot in your rendered Quarto Report, use print()
theme_ef <- function(base_size = 12) {
theme_classic(base_size = base_size) +
theme(
plot.title   = element_text(size = base_size + 4, face = "bold", hjust = 0.5),
axis.title   = element_text(size = base_size + 2),
axis.text    = element_text(size = base_size),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
panel.grid.major.y = element_line(color = "grey85", linewidth = 0.1),
panel.grid.major.x = element_line(color = "grey85", linewidth = 0.1),
legend.position = "bottom",
legend.title    = element_text(size = base_size),
legend.text     = element_text(size = base_size - 1),
plot.margin     = margin(10, 20, 10, 20),
panel.spacing = grid::unit(1, "lines")
)
}
#| label: fig-d-hist-lines
#| fig-cap: "Histogram of D-scores with mean."
## Compute summary statistics
d_mean <- mean(participant_wide$d_score, na.rm = TRUE)
d_sd   <- sd(participant_wide$d_score,  na.rm = TRUE)
## Histogram with reference lines
histogram <- ggplot(participant_wide, aes(x = d_score)) +
geom_histogram(bins = 5,
fill = "gray80",
color = "black") +
geom_vline(xintercept = d_mean,         color = "deepskyblue") +
geom_vline(xintercept = d_mean - d_sd, color = "darkred", linetype = "dashed") +
geom_vline(xintercept = d_mean + d_sd, color = "darkred", linetype = "dashed") +
labs(title= "Distribution of IAT D-Scores", x = "D-score", y = "Count") +
theme_ef()
print(histogram)
#| label: fig-bar
#| fig-cap: "Mean RT between Congruent and Incongruent Trials."
barplot <-
ggplot(data.frame(
condition = c("Congruent", "Incongruent"),
mean_rt = unname(bar_vals),
sd_rt = unname(sd_vals)
),
aes(condition, mean_rt)
) + geom_col(fill = "cyan4") +
labs(title= "Mean RT Across Trials Congruency", x = "Trial", y = "Mean RT (ms)") +
geom_errorbar(aes(ymin = mean_rt - sd_rt, ymax = mean_rt + sd_rt), width=.2)+
theme_ef()
print(barplot)
